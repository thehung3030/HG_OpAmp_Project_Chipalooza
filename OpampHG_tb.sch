v {xschem version=3.4.5 file_version=1.2
}
G {}
K {}
V {}
S {}
E {}
B 2 1670 -1430 2470 -1030 {flags=graph
y1=2.7e-08
y2=1.7e-05
ypos1=0
ypos2=2
divy=5
subdivy=1
unity=1
x1=0
x2=7
divx=5
subdivx=8
xlabmag=1.0
ylabmag=1.0
node="inoise_spectrum
onoise_spectrum"
color="4 7"
dataset=-1
unitx=1
logx=1
logy=0
hilight_wave=2}
N 60 -200 200 -200 {
lab=GND}
N 200 -200 250 -200 {
lab=GND}
N 250 -200 270 -200 {
lab=GND}
N 270 -200 270 -150 {
lab=GND}
N 520 -220 520 -150 {
lab=GND}
N 520 -370 520 -340 {
lab=#net1}
N 60 -370 60 -260 {
lab=#net2}
N 200 -290 200 -260 {
lab=vinp}
N 250 -290 250 -260 {
lab=vinn}
N 340 -320 390 -320 {
lab=vinp}
N 340 -240 390 -240 {
lab=vinn}
N 460 -200 460 -160 {
lab=vbias}
N 120 -300 120 -260 {
lab=vbias}
N 640 -280 680 -280 {
lab=Vout}
N 660 -280 660 -240 {
lab=Vout}
N 520 -180 660 -180 {
lab=GND}
N 80 -840 80 -700 {
lab=#net3}
N 80 -840 410 -840 {
lab=#net3}
N 410 -840 410 -800 {
lab=#net3}
N 230 -590 230 -570 {
lab=GND}
N 230 -590 410 -590 {
lab=GND}
N 410 -680 410 -590 {
lab=GND}
N 80 -640 150 -640 {
lab=GND}
N 150 -640 230 -640 {
lab=GND}
N 230 -640 230 -590 {
lab=GND}
N 350 -660 350 -620 {
lab=vbias}
N 530 -740 560 -740 {
lab=Vout_DC}
N 220 -700 270 -700 {
lab=Vout_DC}
N 270 -700 280 -700 {
lab=Vout_DC}
N 130 -720 130 -640 {
lab=GND}
N 130 -780 280 -780 {
lab=VDC}
N 550 -740 550 -710 {
lab=Vout_DC}
N 550 -650 550 -590 {
lab=GND}
N 410 -590 550 -590 {
lab=GND}
N 680 -280 930 -280 {
lab=Vout}
N 90 -1270 90 -1130 {
lab=#net4}
N 90 -1270 420 -1270 {
lab=#net4}
N 420 -1270 420 -1230 {
lab=#net4}
N 240 -1020 240 -1000 {
lab=GND}
N 240 -1020 420 -1020 {
lab=GND}
N 420 -1110 420 -1020 {
lab=GND}
N 90 -1070 160 -1070 {
lab=GND}
N 160 -1070 240 -1070 {
lab=GND}
N 240 -1070 240 -1020 {
lab=GND}
N 360 -1090 360 -1050 {
lab=vbias}
N 540 -1170 570 -1170 {
lab=Vdc_offset}
N 280 -1130 290 -1130 {
lab=#net5}
N 560 -1170 560 -1140 {
lab=Vdc_offset}
N 560 -1080 560 -1020 {
lab=GND}
N 420 -1020 560 -1020 {
lab=GND}
N 170 -1220 290 -1220 {
lab=#net6}
N 290 -1220 290 -1210 {
lab=#net6}
N 170 -1160 170 -1130 {
lab=#net5}
N 170 -1140 280 -1140 {
lab=#net5}
N 280 -1140 280 -1130 {
lab=#net5}
N 80 -1630 80 -1490 {
lab=#net7}
N 80 -1630 410 -1630 {
lab=#net7}
N 410 -1630 410 -1590 {
lab=#net7}
N 230 -1380 230 -1360 {
lab=GND}
N 230 -1380 410 -1380 {
lab=GND}
N 410 -1470 410 -1380 {
lab=GND}
N 80 -1430 150 -1430 {
lab=GND}
N 150 -1430 230 -1430 {
lab=GND}
N 230 -1430 230 -1380 {
lab=GND}
N 350 -1450 350 -1410 {
lab=vbias}
N 530 -1530 560 -1530 {
lab=Open_loop}
N 270 -1490 280 -1490 {
lab=inn_OL}
N 550 -1530 550 -1500 {
lab=Open_loop}
N 550 -1440 550 -1380 {
lab=GND}
N 410 -1380 550 -1380 {
lab=GND}
N 160 -1580 280 -1580 {
lab=inp_OL}
N 280 -1580 280 -1570 {
lab=inp_OL}
N 160 -1520 160 -1490 {
lab=inn_OL}
N 160 -1500 270 -1500 {
lab=inn_OL}
N 270 -1500 270 -1490 {
lab=inn_OL}
N 860 -1650 860 -1510 {
lab=#net8}
N 860 -1650 1190 -1650 {
lab=#net8}
N 1190 -1650 1190 -1610 {
lab=#net8}
N 1010 -1400 1010 -1380 {
lab=GND}
N 1010 -1400 1190 -1400 {
lab=GND}
N 1190 -1490 1190 -1400 {
lab=GND}
N 860 -1450 930 -1450 {
lab=GND}
N 930 -1450 1010 -1450 {
lab=GND}
N 1010 -1450 1010 -1400 {
lab=GND}
N 1130 -1470 1130 -1430 {
lab=vbias}
N 1310 -1550 1340 -1550 {
lab=CM_gain}
N 1050 -1510 1060 -1510 {
lab=in_CM}
N 1330 -1550 1330 -1520 {
lab=CM_gain}
N 1330 -1460 1330 -1400 {
lab=GND}
N 1190 -1400 1330 -1400 {
lab=GND}
N 940 -1540 940 -1510 {
lab=#net9}
N 1050 -1520 1050 -1510 {
lab=in_CM}
N 1060 -1620 1060 -1590 {
lab=in_CM}
N 940 -1620 1060 -1620 {
lab=in_CM}
N 940 -1620 940 -1600 {
lab=in_CM}
N 1050 -1620 1050 -1520 {
lab=in_CM}
N 850 -1280 850 -1140 {
lab=#net10}
N 850 -1280 1180 -1280 {
lab=#net10}
N 1180 -1280 1180 -1240 {
lab=#net10}
N 1000 -1030 1000 -1010 {
lab=GND}
N 1000 -1030 1180 -1030 {
lab=GND}
N 1180 -1120 1180 -1030 {
lab=GND}
N 850 -1080 920 -1080 {
lab=GND}
N 920 -1080 1000 -1080 {
lab=GND}
N 1000 -1080 1000 -1030 {
lab=GND}
N 1120 -1100 1120 -1060 {
lab=vbias}
N 1300 -1180 1330 -1180 {
lab=OCMR}
N 990 -1140 1040 -1140 {
lab=OCMR}
N 1040 -1140 1050 -1140 {
lab=OCMR}
N 900 -1160 900 -1080 {
lab=GND}
N 900 -1220 1050 -1220 {
lab=ICMR}
N 1320 -1180 1320 -1150 {
lab=OCMR}
N 1320 -1090 1320 -1030 {
lab=GND}
N 1180 -1030 1320 -1030 {
lab=GND}
N 850 -910 850 -770 {
lab=#net11}
N 850 -910 1180 -910 {
lab=#net11}
N 1180 -910 1180 -870 {
lab=#net11}
N 1000 -660 1000 -640 {
lab=GND}
N 1000 -660 1180 -660 {
lab=GND}
N 1180 -750 1180 -660 {
lab=GND}
N 850 -710 920 -710 {
lab=GND}
N 920 -710 1000 -710 {
lab=GND}
N 1000 -710 1000 -660 {
lab=GND}
N 1120 -730 1120 -690 {
lab=vbias}
N 1300 -810 1330 -810 {
lab=Output_noise}
N 990 -770 1040 -770 {
lab=Output_noise}
N 1040 -770 1050 -770 {
lab=Output_noise}
N 900 -790 900 -710 {
lab=GND}
N 900 -850 1050 -850 {
lab=Input_noise}
N 1320 -810 1320 -780 {
lab=Output_noise}
N 1320 -720 1320 -660 {
lab=GND}
N 1180 -660 1320 -660 {
lab=GND}
N 1330 -810 1430 -810 {
lab=Output_noise}
N 1420 -810 1420 -780 {
lab=Output_noise}
N 1420 -720 1420 -660 {
lab=GND}
N 1320 -660 1420 -660 {
lab=GND}
N 60 -410 60 -370 {
lab=#net2}
N 60 -410 220 -410 {
lab=#net2}
N 280 -410 520 -410 {
lab=#net1}
N 520 -410 520 -370 {
lab=#net1}
N 820 -200 820 -180 {
lab=GND}
N 660 -180 820 -180 {
lab=GND}
C {devices/title.sym} 160 30 0 0 {name=l1 author="The-Hung"}
C {devices/vsource.sym} 200 -230 0 0 {name=Vp value="SIN(1.6 1m 1K 0 0.0 0.0)" savecurrent=false}
C {devices/vsource.sym} 250 -230 0 0 {name=Vn value="SIN(1.6 1m 1K 0 0.0 180)" savecurrent=false}
C {devices/vsource.sym} 60 -230 0 0 {name=VDD value=3.3 savecurrent=false}
C {devices/gnd.sym} 270 -150 0 0 {name=l2 lab=GND}
C {devices/gnd.sym} 520 -150 0 0 {name=l3 lab=GND}
C {devices/vsource.sym} 120 -230 0 0 {name=Vbias value=1.12 savecurrent=false}
C {devices/lab_pin.sym} 200 -280 0 0 {name=p1 sig_type=std_logic lab=vinp}
C {devices/lab_pin.sym} 360 -320 1 0 {name=p2 sig_type=std_logic lab=vinp}
C {devices/lab_pin.sym} 250 -280 0 0 {name=p3 sig_type=std_logic lab=vinn
}
C {devices/lab_pin.sym} 360 -240 1 0 {name=p4 sig_type=std_logic lab=vinn
}
C {devices/lab_pin.sym} 120 -290 0 0 {name=p5 sig_type=std_logic lab=vbias
}
C {devices/lab_pin.sym} 460 -170 0 0 {name=p6 sig_type=std_logic lab=vbias
}
C {devices/opin.sym} 930 -280 0 0 {name=p7 lab=Vout
}
C {devices/code_shown.sym} 1670 -940 0 0 {name=spice only_toplevel=false 
value="
.lib /foss/pdks/sky130A/libs.tech/ngspice/sky130.lib.spice tt
.control

*****************dc analysis************
*dc VDC7 0 3.3 0.1
*plot v(OCMR) v(ICMR)
*dc VDC2 -5m 5m 1m    
*plot v(Vdc_offset)


*****************AC analysis************
ac dec 20 1 1e10
let Open_Loop_Gain = v(Open_loop)/(v(inp_OL)-v(inn_OL))
let Common_mode_gain = v(CM_gain)/v(in_CM)
let Phase_Degree=180*cph(v(Open_loop)/(v(inp_OL)-v(inn_OL)))/pi
let CMRR=Open_Loop_Gain/Common_mode_gain
plot v(Vout_DC)
plot db(Open_Loop_Gain)
plot Phase_Degree
plot db(CMRR)
write Output_AC.raw

****************Transient Analysis******
*tran 0.1m 5m
*plot v(vinp) v(vinn) 
*plot v(Vout) 
*plot v(x3.vout_prior)
*write Output_tran.raw

*****************Noise Analysis**********
*noise v(Output_noise, 0) VDC8 dec 10 1 1e7
*setplot noise1
*write noise1.raw


.endc
"}
C {sky130_fd_pr/cap_mim_m3_2.sym} 660 -210 0 0 {name=C1 model=cap_mim_m3_2 W=63 L=40 MF=1 spiceprefix=X}
C {/foss/designs/Opamp_HG/OpampHG.sym} 540 -280 0 0 {name=x3}
C {/foss/designs/Opamp_HG/OpampHG.sym} 430 -740 0 0 {name=x1}
C {devices/vsource.sym} 80 -670 0 0 {name=VDD1 value=3.3 savecurrent=false}
C {devices/gnd.sym} 230 -570 0 0 {name=l4 lab=GND}
C {devices/lab_pin.sym} 350 -640 0 0 {name=p8 sig_type=std_logic lab=vbias
}
C {devices/opin.sym} 560 -740 0 0 {name=p9 lab=Vout_DC}
C {devices/lab_pin.sym} 240 -700 0 0 {name=p10 sig_type=std_logic lab=Vout_DC}
C {devices/vsource.sym} 130 -750 0 0 {name=VDC value="1.65 AC 1" savecurrent=false}
C {devices/lab_wire.sym} 200 -780 1 0 {name=p12 sig_type=std_logic lab=VDC}
C {sky130_fd_pr/cap_mim_m3_2.sym} 550 -680 0 0 {name=C2 model=cap_mim_m3_2 W=63 L=40 MF=1 spiceprefix=X}
C {devices/res.sym} 1420 -750 0 0 {name=R1
value=5k
footprint=1206
device=resistor
m=1}
C {/foss/designs/Opamp_HG/OpampHG.sym} 440 -1170 0 0 {name=x2}
C {devices/vsource.sym} 90 -1100 0 0 {name=VDD2 value=3.3 savecurrent=false}
C {devices/gnd.sym} 240 -1000 0 0 {name=l5 lab=GND}
C {devices/lab_pin.sym} 360 -1070 0 0 {name=p11 sig_type=std_logic lab=vbias
}
C {devices/opin.sym} 570 -1170 0 0 {name=p13 lab=Vdc_offset}
C {devices/vsource.sym} 170 -1100 0 0 {name=VDC1 value="1.65" savecurrent=false}
C {sky130_fd_pr/cap_mim_m3_2.sym} 560 -1110 0 0 {name=C3 model=cap_mim_m3_2 W=63 L=40 MF=1 spiceprefix=X}
C {devices/vsource.sym} 170 -1190 0 0 {name=VDC2 value="0" savecurrent=false}
C {/foss/designs/Opamp_HG/OpampHG.sym} 430 -1530 0 0 {name=x4}
C {devices/vsource.sym} 80 -1460 0 0 {name=VDD3 value=3.3 savecurrent=false}
C {devices/gnd.sym} 230 -1360 0 0 {name=l6 lab=GND}
C {devices/lab_pin.sym} 350 -1430 0 0 {name=p14 sig_type=std_logic lab=vbias
}
C {devices/opin.sym} 560 -1530 0 0 {name=p15 lab=Open_loop}
C {devices/vsource.sym} 160 -1460 0 0 {name=VDC3 value="1.65" savecurrent=false}
C {sky130_fd_pr/cap_mim_m3_2.sym} 550 -1470 0 0 {name=C4 model=cap_mim_m3_2 W=63 L=40 MF=1 spiceprefix=X}
C {devices/vsource.sym} 160 -1550 0 0 {name=VDC4 value="AC 1" savecurrent=false}
C {devices/lab_pin.sym} 220 -1580 1 0 {name=p16 sig_type=std_logic lab=inp_OL}
C {devices/lab_pin.sym} 230 -1500 1 0 {name=p17 sig_type=std_logic lab=inn_OL}
C {/foss/designs/Opamp_HG/OpampHG.sym} 1210 -1550 0 0 {name=x5}
C {devices/vsource.sym} 860 -1480 0 0 {name=VDD4 value=3.3 savecurrent=false}
C {devices/gnd.sym} 1010 -1380 0 0 {name=l7 lab=GND}
C {devices/lab_pin.sym} 1130 -1450 0 0 {name=p18 sig_type=std_logic lab=vbias
}
C {devices/opin.sym} 1340 -1550 0 0 {name=p19 lab=CM_gain}
C {devices/vsource.sym} 940 -1480 0 0 {name=VDC5 value="1.65" savecurrent=false}
C {sky130_fd_pr/cap_mim_m3_2.sym} 1330 -1490 0 0 {name=C5 model=cap_mim_m3_2 W=63 L=40 MF=1 spiceprefix=X}
C {devices/vsource.sym} 940 -1570 0 0 {name=VDC6 value="AC 1" savecurrent=false}
C {devices/lab_pin.sym} 1010 -1620 3 0 {name=p20 sig_type=std_logic lab=in_CM}
C {/foss/designs/Opamp_HG/OpampHG.sym} 1200 -1180 0 0 {name=x6}
C {devices/vsource.sym} 850 -1110 0 0 {name=VDD5 value=3.3 savecurrent=false}
C {devices/gnd.sym} 1000 -1010 0 0 {name=l8 lab=GND}
C {devices/lab_pin.sym} 1120 -1080 0 0 {name=p21 sig_type=std_logic lab=vbias
}
C {devices/opin.sym} 1330 -1180 0 0 {name=p22 lab=OCMR}
C {devices/lab_pin.sym} 1010 -1140 0 0 {name=p23 sig_type=std_logic lab=OCMR}
C {devices/vsource.sym} 900 -1190 0 0 {name=VDC7 value="0" savecurrent=false}
C {devices/lab_wire.sym} 970 -1220 1 0 {name=p24 sig_type=std_logic lab=ICMR}
C {sky130_fd_pr/cap_mim_m3_2.sym} 1320 -1120 0 0 {name=C6 model=cap_mim_m3_2 W=63 L=40 MF=1 spiceprefix=X}
C {/foss/designs/Opamp_HG/OpampHG.sym} 1200 -810 0 0 {name=x7}
C {devices/vsource.sym} 850 -740 0 0 {name=VDD6 value=3.3 savecurrent=false}
C {devices/gnd.sym} 1000 -640 0 0 {name=l9 lab=GND}
C {devices/lab_pin.sym} 1120 -710 0 0 {name=p25 sig_type=std_logic lab=vbias
}
C {devices/opin.sym} 1430 -810 0 0 {name=p26 lab=Output_noise}
C {devices/lab_pin.sym} 1040 -770 0 0 {name=p27 sig_type=std_logic lab=Output_noise}
C {devices/vsource.sym} 900 -820 0 0 {name=VDC8 value="1 AC 1" savecurrent=false}
C {devices/lab_wire.sym} 950 -850 2 0 {name=p28 sig_type=std_logic lab=Input_noise}
C {sky130_fd_pr/cap_mim_m3_2.sym} 1320 -750 0 0 {name=C7 model=cap_mim_m3_2 W=63 L=40 MF=1 spiceprefix=X}
C {devices/launcher.sym} 1740 -1460 0 0 {name=h5
descr="load waves" 
tclcommand="xschem raw_read $netlist_dir/noise1.raw noise"
}
C {devices/res.sym} 820 -230 0 0 {name=R2
value=5k
footprint=1206
device=resistor
m=1}
C {devices/ammeter.sym} 250 -410 3 0 {name=Vmeas savecurrent=true}
